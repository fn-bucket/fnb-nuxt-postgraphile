query CurrentAppTenant {
  currentAppTenant {
    id
    name
    parentAppTenantId
    type
    subsidiaries: appTenantsByParentAppTenantId(
      condition: {
        type: SUBSIDIARY
      }
    ) {
      nodes {
        id
        name
      }
    }
    appUsers: appUsersByAppTenantId {
      nodes {
        id
        username
        inactive
        permissionKey
        licenses: licensesByAssignedToAppUserId {
          nodes {
            id
            name
            licenseTypeKey
          }
        }
      }
    }
    anchorSubscription: appTenantSubscriptionByAnchorSubscriptionId {
      id
      expirationDate
      licensePack: licensePackByLicensePackId {
        id
        name
        key
        type
        availability
      }
      payments: paymentsByAppTenantSubscriptionId {
        nodes	{
          id
          billingDate
          paymentDate
          canceledDate
          amount
          status
        }
      }        
    }
		appTenantSubscriptions: activeSubscriptions {
      nodes {
        id
        appTenantId
        expirationDate
        inactive
        isAnchorSubscription
        availableUpgradePaths {
          nodes {
            id
            key
            name
          }
        }
        availableAddOns {
          nodes {
            id
            key
            name
          }
        }
        availableLicenses {
          nodes {
            licensePackLicenseType {
              id
              licenseTypeKey
            }
            availableCount
            provisionedCount
            activeCount
            inactiveCount
            canProvision
            voidCount
            expiredCount
          }
        }
        appTenant: appTenantByAppTenantId {
          id
          name
          appUsersByAppTenantId(
            condition: { permissionKey: ADMIN }
            first: 1
            orderBy: CREATED_AT_DESC
          ) {
            nodes {
              id
              username
              contact: contactByContactId {
                id
                firstName
                lastName
                email
              }
            }
          }
        }
        licensePack: licensePackByLicensePackId {
          id
          name
          key
          price
          type
          availability
          renewalFrequency
          upgradeConfig {
            upgradePaths {
              licensePackKey
              licenseTypeUpgrades {
                sourceLicenseTypeKey
                targetLicenseTypeKey
              }
            }
          }
          licenseTypes: licensePackLicenseTypesByLicensePackId {
            nodes {
              id
              licenseTypeKey
              licenseCount
              assignUponSubscription
              unlimitedProvision
            }
          }
        }
        assignedLicenses: licensesBySubscriptionId {
          nodes {
            id
            name
            licenseTypeKey
            inactive
            canActivate
            assignedToAppUser: appUserByAssignedToAppUserId {
              id
              username
              appTenant: appTenantByAppTenantId {
                id
                name
              }
              contact: contactByContactId {
                id
                fullName
                firstName
                lastName
                email
                cellPhone
                officePhone
              }
            }
          }
        }
      }
    }
    activeLicenses: licensesByAppTenantId(
      condition: {
        status: ACTIVE
      }
    ) {
      nodes {
        id
        name
        licenseTypeKey
        expirationDate
        status
        statusReason
        inactive
        assignedToAppUser: appUserByAssignedToAppUserId {
          id
          username
          contact: contactByContactId {
            id
            firstName
            lastName
            email
          }
        }
        subscription: appTenantSubscriptionBySubscriptionId {
          id
          isAnchorSubscription
          licensePack: licensePackByLicensePackId	{
            id
            key
          }
        }
      }
    }
  }

  currentAppTenantActiveSubscriptions {
    nodes {
      ...Subscription
    }
  }
  currentAppTenantInactiveSubscriptions {
    nodes {
      ...Subscription
    }
  }
}


fragment Subscription on AppTenantSubscription {
  id
  appTenantId
  expirationDate
  inactive
  isAnchorSubscription
  availableUpgradePaths {
    nodes {
      id
      key
      name
    }
  }
  availableAddOns {
    nodes {
      id
      key
      name
    }
  }
  availableLicenses {
    nodes {
      licensePackLicenseType {
        id
        licenseTypeKey
      }
      availableCount
      provisionedCount
      activeCount
      inactiveCount
      canProvision
      voidCount
      expiredCount
    }
  }
  appTenant: appTenantByAppTenantId {
    id
    name
    appUsersByAppTenantId(
      condition: { permissionKey: ADMIN }
      first: 1
      orderBy: CREATED_AT_DESC
    ) {
      nodes {
        id
        username
        contact: contactByContactId {
          id
          firstName
          lastName
          email
        }
      }
    }
  }
  licensePack: licensePackByLicensePackId {
    id
    name
    key
    price
    type
    availability
    renewalFrequency
    upgradeConfig {
      upgradePaths {
        licensePackKey
        licenseTypeUpgrades {
          sourceLicenseTypeKey
          targetLicenseTypeKey
        }
      }
    }
    licenseTypes: licensePackLicenseTypesByLicensePackId {
      nodes {
        id
        licenseTypeKey
        licenseCount
        assignUponSubscription
        unlimitedProvision
      }
    }
  }
  assignedLicenses: licensesBySubscriptionId {
    nodes {
      id
      name
      licenseTypeKey
      inactive
      canActivate
      assignedToAppUser: appUserByAssignedToAppUserId {
        id
        username
        appTenant: appTenantByAppTenantId {
          id
          name
        }
        contact: contactByContactId {
          id
          fullName
          firstName
          lastName
          email
          cellPhone
          officePhone
        }
      }
    }
  }
}